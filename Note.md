实现计划已经完整了。包含以下内容：                                                                                                                                                                        
                                                                                                                                                                                                            
  计划文档结构                                                                                                                                                                                              
  ┌──────────────┬──────────────────────────────────────────────────┐                                                                                                                                       
  │     章节     │                       内容                       │                                                                                                                                       
  ├──────────────┼──────────────────────────────────────────────────┤                                                                                                                                       
  │ 项目概述     │ Love Cook 定位与目标                             │                                                                                                                                       
  ├──────────────┼──────────────────────────────────────────────────┤                                                                                                                                       
  │ 平台与技术   │ Flutter Web + Claude API + 本地存储              │                                                                                                                                       
  ├──────────────┼──────────────────────────────────────────────────┤                                                                                                                                       
  │ 完整功能清单 │ 7 大模块，51 项功能                              │                                                                                                                                       
  ├──────────────┼──────────────────────────────────────────────────┤                                                                                                                                       
  │ 技术架构     │ 项目结构、状态管理（Riverpod）、数据库（Isar）   │                                                                                                                                       
  ├──────────────┼──────────────────────────────────────────────────┤                                                                                                                                       
  │ 数据模型     │ 家庭、成员、食材、菜谱、菜单、购物清单等实体设计 │                                                                                                                                       
  ├──────────────┼──────────────────────────────────────────────────┤                                                                                                                                       
  │ AI 服务设计  │ 7 个 AI 功能点及接口定义                         │                                                                                                                                       
  ├──────────────┼──────────────────────────────────────────────────┤                                                                                                                                       
  │ 页面结构     │ 6 大页面模块的导航结构                           │                                                                                                                                       
  ├──────────────┼──────────────────────────────────────────────────┤                                                                                                                                       
  │ 实现步骤     │ 7 个阶段的开发计划                               │                                                                                                                                       
  ├──────────────┼──────────────────────────────────────────────────┤                                                                                                                                       
  │ 关键依赖     │ 完整的 pubspec.yaml 配置                         │                                                                                                                                       
  ├──────────────┼──────────────────────────────────────────────────┤                                                                                                                                       
  │ 验证方案     │ 功能验证清单和测试方法                           │                                                                                                                                       
  ├──────────────┼──────────────────────────────────────────────────┤                                                                                                                                       
  │ 注意事项     │ 语气风格、健康声明、隐私保护等                   │                                                                                                                                       
  └──────────────┴──────────────────────────────────────────────────┘                                                                                                                                       
  计划文件位置：/Users/xianxuefeng/.claude/plans/snug-mapping-ember.md                                                                                                                                      
                                                                                                                                                                                                            
  如果没有其他问题，我将提交计划供你审批。                                                                                                                                                                  
                                                                                                                                                                                                            
⏺ User approved Claude's plan                                                                                                                                                                               
  ⎿  Plan saved to: ~/.claude/plans/snug-mapping-ember.md · /plan to edit                                                                                                                                   
     Love Cook 实现计划                                                                                                                                                                                     
                                                                                                                                                                                                            
     项目概述                                                                                                                                                                                               
                                                                                                                                                                                                            
     Love Cook 是一个温和、体贴的家庭餐食 AI 助手，帮助家庭建立独立餐食档案，生成健康、经济、可持续的家庭餐计划。                                                                                           
                                                                                                                                                                                                            
     ---                                                                                                                                                                                                    
     需求确认摘要                                                                                                                                                                                           
                                                                                                                                                                                                            
     平台与技术                                                                                                                                                                                             
     ┌──────────┬─────────────────────────────────────┐                                                                                                                                                     
     │   项目   │                选择                 │                                                                                                                                                     
     ├──────────┼─────────────────────────────────────┤                                                                                                                                                     
     │ 运行平台 │ Flutter Web（可扩展至 iOS/Android） │                                                                                                                                                     
     ├──────────┼─────────────────────────────────────┤                                                                                                                                                     
     │ AI 方案  │ Claude/GPT API                      │                                                                                                                                                     
     ├──────────┼─────────────────────────────────────┤                                                                                                                                                     
     │ 数据存储 │ 本地优先（Hive/Isar）               │                                                                                                                                                     
     ├──────────┼─────────────────────────────────────┤                                                                                                                                                     
     │ UI 风格  │ 简洁清新（Apple 风格）              │                                                                                                                                                     
     ├──────────┼─────────────────────────────────────┤                                                                                                                                                     
     │ 界面语言 │ 多语言支持                          │                                                                                                                                                     
     └──────────┴─────────────────────────────────────┘                                                                                                                                                     
     核心功能需求摘要                                                                                                                                                                                       
     ┌──────────────┬────────────────────────────────────────────┐                                                                                                                                          
     │     功能     │                  详细要求                  │                                                                                                                                          
     ├──────────────┼────────────────────────────────────────────┤                                                                                                                                          
     │ 家庭档案     │ 支持多家庭/账户切换                        │                                                                                                                                          
     ├──────────────┼────────────────────────────────────────────┤                                                                                                                                          
     │ 健康状况     │ 用户从预设列表手动选择，冲突时 AI 智能平衡 │                                                                                                                                          
     ├──────────────┼────────────────────────────────────────────┤                                                                                                                                          
     │ 菜谱来源     │ AI 实时生成 + 用户收藏复用                 │                                                                                                                                          
     ├──────────────┼────────────────────────────────────────────┤                                                                                                                                          
     │ 营养分析     │ AI 估算即可，无需精确数据库                │                                                                                                                                          
     ├──────────────┼────────────────────────────────────────────┤                                                                                                                                          
     │ 拍照识别     │ 识别种类 + 数量估算 + 新鲜度 + 存放建议    │                                                                                                                                          
     ├──────────────┼────────────────────────────────────────────┤                                                                                                                                          
     │ 语音输入     │ 多语言支持                                 │                                                                                                                                          
     ├──────────────┼────────────────────────────────────────────┤                                                                                                                                          
     │ 菜单周期     │ 灵活选择 1-7 天                            │                                                                                                                                          
     ├──────────────┼────────────────────────────────────────────┤                                                                                                                                          
     │ 餐次设置     │ 可配置（早/中/晚/加餐）                    │                                                                                                                                          
     ├──────────────┼────────────────────────────────────────────┤                                                                                                                                          
     │ 存储位置     │ 统一管理，不区分位置                       │                                                                                                                                          
     ├──────────────┼────────────────────────────────────────────┤                                                                                                                                          
     │ 保质期       │ 默认 AI 估算，用户可修改                   │                                                                                                                                          
     ├──────────────┼────────────────────────────────────────────┤                                                                                                                                          
     │ 食材推荐     │ 必须支持根据库存推荐菜谱                   │                                                                                                                                          
     ├──────────────┼────────────────────────────────────────────┤                                                                                                                                          
     │ 菜谱详细度   │ 完整食谱（用量、步骤、时间、技巧）         │                                                                                                                                          
     ├──────────────┼────────────────────────────────────────────┤                                                                                                                                          
     │ 购物清单导出 │ 复制、分享、导出图片/PDF                   │                                                                                                                                          
     └──────────────┴────────────────────────────────────────────┘                                                                                                                                          
     ---                                                                                                                                                                                                    
     完整功能清单（51 项）                                                                                                                                                                                  
                                                                                                                                                                                                            
     1️⃣ 家庭档案管理（8 项）                                                                                                                                                                                
     ┌─────┬─────────────┬──────────────────────────────────────────────────────────────────┐                                                                                                               
     │  #  │   功能项    │                               说明                               │                                                                                                               
     ├─────┼─────────────┼──────────────────────────────────────────────────────────────────┤                                                                                                               
     │ 1   │ 多家庭/账户 │ 支持创建多个家庭档案，可切换                                     │                                                                                                               
     ├─────┼─────────────┼──────────────────────────────────────────────────────────────────┤                                                                                                               
     │ 2   │ 成员管理    │ 添加/编辑/删除家庭成员                                           │                                                                                                               
     ├─────┼─────────────┼──────────────────────────────────────────────────────────────────┤                                                                                                               
     │ 3   │ 年龄分组    │ 婴幼儿/儿童/青少年/成人/老年                                     │                                                                                                               
     ├─────┼─────────────┼──────────────────────────────────────────────────────────────────┤                                                                                                               
     │ 4   │ 健康状况    │ 预设列表选择：控糖、脂肪肝、三高、减脂期、儿童成长、孕期、素食等 │                                                                                                               
     ├─────┼─────────────┼──────────────────────────────────────────────────────────────────┤                                                                                                               
     │ 5   │ 忌口记录    │ 家庭或个人的食物忌口                                             │                                                                                                               
     ├─────┼─────────────┼──────────────────────────────────────────────────────────────────┤                                                                                                               
     │ 6   │ 过敏源      │ 记录过敏食材                                                     │                                                                                                               
     ├─────┼─────────────┼──────────────────────────────────────────────────────────────────┤                                                                                                               
     │ 7   │ 口味偏好    │ 喜欢/不喜欢/常用食材                                             │                                                                                                               
     ├─────┼─────────────┼──────────────────────────────────────────────────────────────────┤                                                                                                               
     │ 8   │ 餐次配置    │ 自定义早餐/午餐/晚餐/加餐                                        │                                                                                                               
     └─────┴─────────────┴──────────────────────────────────────────────────────────────────┘                                                                                                               
     2️⃣ 智能库存管理（10 项）                                                                                                                                                                               
     ┌─────┬─────────────┬─────────────────────────────────────┐                                                                                                                                            
     │  #  │   功能项    │                说明                 │                                                                                                                                            
     ├─────┼─────────────┼─────────────────────────────────────┤                                                                                                                                            
     │ 1   │ 📸 拍照识别 │ 拍摄冰箱/储物柜，AI 识别食材        │                                                                                                                                            
     ├─────┼─────────────┼─────────────────────────────────────┤                                                                                                                                            
     │ 2   │ ↳ 识别内容  │ 种类 + 数量估算 + 新鲜度 + 存放建议 │                                                                                                                                            
     ├─────┼─────────────┼─────────────────────────────────────┤                                                                                                                                            
     │ 3   │ 🎙️ 语音输入 │ 多语言语音录入（如"三根胡萝卜"）    │                                                                                                                                            
     ├─────┼─────────────┼─────────────────────────────────────┤                                                                                                                                            
     │ 4   │ ✍️ 手动输入 │ 文字输入或粘贴采购单                │                                                                                                                                            
     ├─────┼─────────────┼─────────────────────────────────────┤                                                                                                                                            
     │ 5   │ 自动合并    │ 重复食材智能合并                    │                                                                                                                                            
     ├─────┼─────────────┼─────────────────────────────────────┤                                                                                                                                            
     │ 6   │ 库存列表    │ 名称/数量/状态/存储建议/保质期      │                                                                                                                                            
     ├─────┼─────────────┼─────────────────────────────────────┤                                                                                                                                            
     │ 7   │ 保质期管理  │ AI 估算，用户可修改                 │                                                                                                                                            
     ├─────┼─────────────┼─────────────────────────────────────┤                                                                                                                                            
     │ 8   │ 临期提醒    │ ⚠️ 快过期自动提醒                   │                                                                                                                                            
     ├─────┼─────────────┼─────────────────────────────────────┤                                                                                                                                            
     │ 9   │ 自动扣减    │ 生成菜单后自动减少已用量            │                                                                                                                                            
     ├─────┼─────────────┼─────────────────────────────────────┤                                                                                                                                            
     │ 10  │ 补货提示    │ 库存为零或低于阈值时提醒            │                                                                                                                                            
     └─────┴─────────────┴─────────────────────────────────────┘                                                                                                                                            
     3️⃣ AI 菜单生成（8 项）                                                                                                                                                                                 
     ┌─────┬──────────┬───────────────────────────────────────────┐                                                                                                                                         
     │  #  │  功能项  │                   说明                    │                                                                                                                                         
     ├─────┼──────────┼───────────────────────────────────────────┤                                                                                                                                         
     │ 1   │ 灵活周期 │ 可选 1-7 天                               │                                                                                                                                         
     ├─────┼──────────┼───────────────────────────────────────────┤                                                                                                                                         
     │ 2   │ 餐次定制 │ 按需选择包含哪些餐                        │                                                                                                                                         
     ├─────┼──────────┼───────────────────────────────────────────┤                                                                                                                                         
     │ 3   │ 库存优先 │ 优先消耗现有食材，减少浪费                │                                                                                                                                         
     ├─────┼──────────┼───────────────────────────────────────────┤                                                                                                                                         
     │ 4   │ 健康适配 │ 根据成员健康状况定制                      │                                                                                                                                         
     ├─────┼──────────┼───────────────────────────────────────────┤                                                                                                                                         
     │ 5   │ 智能平衡 │ 需求冲突时（控糖 vs 儿童成长）AI 自动折中 │                                                                                                                                         
     ├─────┼──────────┼───────────────────────────────────────────┤                                                                                                                                         
     │ 6   │ 菜单预览 │ 生成后可预览调整                          │                                                                                                                                         
     ├─────┼──────────┼───────────────────────────────────────────┤                                                                                                                                         
     │ 7   │ 菜品替换 │ 不满意可手动换菜                          │                                                                                                                                         
     ├─────┼──────────┼───────────────────────────────────────────┤                                                                                                                                         
     │ 8   │ 历史菜单 │ 保存查看历史记录                          │                                                                                                                                         
     └─────┴──────────┴───────────────────────────────────────────┘                                                                                                                                         
     4️⃣ 菜谱详情（7 项）                                                                                                                                                                                    
     ┌─────┬───────────┬──────────────────────────────────────┐                                                                                                                                             
     │  #  │  功能项   │                 说明                 │                                                                                                                                             
     ├─────┼───────────┼──────────────────────────────────────┤                                                                                                                                             
     │ 1   │ 完整食谱  │ 详细用量、步骤、时间、技巧           │                                                                                                                                             
     ├─────┼───────────┼──────────────────────────────────────┤                                                                                                                                             
     │ 2   │ 库存推荐  │ 根据现有食材推荐可做菜谱 ⭐ 核心功能 │                                                                                                                                             
     ├─────┼───────────┼──────────────────────────────────────┤                                                                                                                                             
     │ 3   │ AI 新菜谱 │ 按需求实时生成新菜谱                 │                                                                                                                                             
     ├─────┼───────────┼──────────────────────────────────────┤                                                                                                                                             
     │ 4   │ 收藏功能  │ 喜欢的菜谱可保存复用                 │                                                                                                                                             
     ├─────┼───────────┼──────────────────────────────────────┤                                                                                                                                             
     │ 5   │ 替代食材  │ 提供食材替换建议                     │                                                                                                                                             
     ├─────┼───────────┼──────────────────────────────────────┤                                                                                                                                             
     │ 6   │ 备菜指导  │ 周前备菜建议                         │                                                                                                                                             
     ├─────┼───────────┼──────────────────────────────────────┤                                                                                                                                             
     │ 7   │ 储存方式  │ 每种食材的储存方法和保鲜时长         │                                                                                                                                             
     └─────┴───────────┴──────────────────────────────────────┘                                                                                                                                             
     5️⃣ 营养分析（4 项）                                                                                                                                                                                    
     ┌─────┬────────────┬────────────────────────────┐                                                                                                                                                      
     │  #  │   功能项   │            说明            │                                                                                                                                                      
     ├─────┼────────────┼────────────────────────────┤                                                                                                                                                      
     │ 1   │ 单菜估算   │ 蛋白质/碳水/脂肪/膳食纤维  │                                                                                                                                                      
     ├─────┼────────────┼────────────────────────────┤                                                                                                                                                      
     │ 2   │ 周汇总     │ 一周营养结构分析           │                                                                                                                                                      
     ├─────┼────────────┼────────────────────────────┤                                                                                                                                                      
     │ 3   │ 不均衡提醒 │ 建议补充 XX 类食物         │                                                                                                                                                      
     ├─────┼────────────┼────────────────────────────┤                                                                                                                                                      
     │ 4   │ 健康声明   │ "仅供参考，不代替医生建议" │                                                                                                                                                      
     └─────┴────────────┴────────────────────────────┘                                                                                                                                                      
     6️⃣ 购物清单（9 项）                                                                                                                                                                                    
     ┌─────┬─────────────┬──────────────────────────────────┐                                                                                                                                               
     │  #  │   功能项    │               说明               │                                                                                                                                               
     ├─────┼─────────────┼──────────────────────────────────┤                                                                                                                                               
     │ 1   │ 自动生成    │ 根据菜单 + 库存自动计算          │                                                                                                                                               
     ├─────┼─────────────┼──────────────────────────────────┤                                                                                                                                               
     │ 2   │ 分类展示    │ 按类别分组（蔬菜/肉类/调味料等） │                                                                                                                                               
     ├─────┼─────────────┼──────────────────────────────────┤                                                                                                                                               
     │ 3   │ 数量建议    │ 基于使用频率和保质期计算         │                                                                                                                                               
     ├─────┼─────────────┼──────────────────────────────────┤                                                                                                                                               
     │ 4   │ 📋 复制文本 │ 一键复制文字版清单               │                                                                                                                                               
     ├─────┼─────────────┼──────────────────────────────────┤                                                                                                                                               
     │ 5   │ 🖼️ 导出图片 │ 生成图片保存                     │                                                                                                                                               
     ├─────┼─────────────┼──────────────────────────────────┤                                                                                                                                               
     │ 6   │ 📄 导出 PDF │ 生成 PDF 文件                    │                                                                                                                                               
     ├─────┼─────────────┼──────────────────────────────────┤                                                                                                                                               
     │ 7   │ 📤 分享     │ 分享到其他应用                   │                                                                                                                                               
     ├─────┼─────────────┼──────────────────────────────────┤                                                                                                                                               
     │ 8   │ ✅ 已购勾选 │ 购物时标记已买项目               │                                                                                                                                               
     ├─────┼─────────────┼──────────────────────────────────┤                                                                                                                                               
     │ 9   │ 无价格/品牌 │ 只提供品类和数量建议             │                                                                                                                                               
     └─────┴─────────────┴──────────────────────────────────┘                                                                                                                                               
     7️⃣ 系统与设置（5 项）                                                                                                                                                                                  
     ┌─────┬───────────────┬──────────────────────────┐                                                                                                                                                     
     │  #  │    功能项     │           说明           │                                                                                                                                                     
     ├─────┼───────────────┼──────────────────────────┤                                                                                                                                                     
     │ 1   │ 🌐 多语言界面 │ 中文/英文等切换          │                                                                                                                                                     
     ├─────┼───────────────┼──────────────────────────┤                                                                                                                                                     
     │ 2   │ 🎨 简洁 UI    │ Apple 风格，清新简约     │                                                                                                                                                     
     ├─────┼───────────────┼──────────────────────────┤                                                                                                                                                     
     │ 3   │ 💾 本地存储   │ 数据优先存设备本地       │                                                                                                                                                     
     ├─────┼───────────────┼──────────────────────────┤                                                                                                                                                     
     │ 4   │ 🔑 API 配置   │ 用户配置 Claude/GPT 密钥 │                                                                                                                                                     
     ├─────┼───────────────┼──────────────────────────┤                                                                                                                                                     
     │ 5   │ 📊 反馈学习   │ 根据用户反馈优化推荐     │                                                                                                                                                     
     └─────┴───────────────┴──────────────────────────┘                                                                                                                                                     
     ---                                                                                                                                                                                                    
     技术架构                                                                                                                                                                                               
                                                                                                                                                                                                            
     项目结构（Feature-First + Clean Architecture）                                                                                                                                                         
                                                                                                                                                                                                            
     lib/                                                                                                                                                                                                   
     ├── main.dart                    # 应用入口                                                                                                                                                            
     ├── app/                                                                                                                                                                                               
     │   ├── app.dart                 # MaterialApp 配置                                                                                                                                                    
     │   ├── router.dart              # GoRouter 路由配置                                                                                                                                                   
     │   └── localization/            # 多语言资源                                                                                                                                                          
     │                                                                                                                                                                                                      
     ├── core/                                                                                                                                                                                              
     │   ├── constants/               # 常量定义                                                                                                                                                            
     │   ├── theme/                   # 主题配置（简洁清新风格）                                                                                                                                            
     │   ├── utils/                   # 通用工具类                                                                                                                                                          
     │   ├── widgets/                 # 通用组件                                                                                                                                                            
     │   └── services/                                                                                                                                                                                      
     │       ├── ai_service.dart      # Claude/GPT API 封装                                                                                                                                                 
     │       ├── storage_service.dart # 本地存储服务                                                                                                                                                        
     │       ├── image_service.dart   # 图片处理服务                                                                                                                                                        
     │       └── speech_service.dart  # 语音识别服务                                                                                                                                                        
     │                                                                                                                                                                                                      
     ├── features/                                                                                                                                                                                          
     │   ├── family/                  # 家庭档案模块                                                                                                                                                        
     │   │   ├── data/                                                                                                                                                                                      
     │   │   │   ├── models/          # 数据模型                                                                                                                                                            
     │   │   │   └── repositories/    # 数据仓库                                                                                                                                                            
     │   │   ├── domain/                                                                                                                                                                                    
     │   │   │   └── entities/        # 领域实体                                                                                                                                                            
     │   │   └── presentation/                                                                                                                                                                              
     │   │       ├── screens/         # 页面                                                                                                                                                                
     │   │       ├── widgets/         # 组件                                                                                                                                                                
     │   │       └── providers/       # 状态管理                                                                                                                                                            
     │   │                                                                                                                                                                                                  
     │   ├── inventory/               # 库存管理模块                                                                                                                                                        
     │   ├── menu/                    # 菜单生成模块                                                                                                                                                        
     │   ├── recipe/                  # 菜谱详情模块                                                                                                                                                        
     │   ├── shopping/                # 购物清单模块                                                                                                                                                        
     │   ├── nutrition/               # 营养分析模块                                                                                                                                                        
     │   └── settings/                # 设置模块                                                                                                                                                            
     │                                                                                                                                                                                                      
     └── l10n/                        # 国际化文件                                                                                                                                                          
         ├── app_zh.arb                                                                                                                                                                                     
         ├── app_en.arb                                                                                                                                                                                     
         └── ...                                                                                                                                                                                            
                                                                                                                                                                                                            
     状态管理：Riverpod                                                                                                                                                                                     
                                                                                                                                                                                                            
     选择 Riverpod 的原因：                                                                                                                                                                                 
     - 类型安全，编译时检查                                                                                                                                                                                 
     - 支持代码生成，减少样板代码                                                                                                                                                                           
     - 便于测试和依赖注入                                                                                                                                                                                   
     - 适合中大型应用                                                                                                                                                                                       
                                                                                                                                                                                                            
     本地存储：Isar                                                                                                                                                                                         
                                                                                                                                                                                                            
     选择 Isar 的原因：                                                                                                                                                                                     
     - 专为 Flutter 设计，性能优秀                                                                                                                                                                          
     - 支持全文搜索                                                                                                                                                                                         
     - 跨平台一致性好                                                                                                                                                                                       
     - 支持复杂查询                                                                                                                                                                                         
                                                                                                                                                                                                            
     ---                                                                                                                                                                                                    
     数据模型设计                                                                                                                                                                                           
                                                                                                                                                                                                            
     核心实体                                                                                                                                                                                               
                                                                                                                                                                                                            
     // 家庭                                                                                                                                                                                                
     @collection                                                                                                                                                                                            
     class Family {                                                                                                                                                                                         
       Id id = Isar.autoIncrement;                                                                                                                                                                          
       String name;                                                                                                                                                                                         
       String? avatarPath;                                                                                                                                                                                  
       DateTime createdAt;                                                                                                                                                                                  
       DateTime updatedAt;                                                                                                                                                                                  
       List<FamilyMember> members;                                                                                                                                                                          
       MealSettings mealSettings;                                                                                                                                                                           
     }                                                                                                                                                                                                      
                                                                                                                                                                                                            
     // 家庭成员                                                                                                                                                                                            
     @embedded                                                                                                                                                                                              
     class FamilyMember {                                                                                                                                                                                   
       String name;                                                                                                                                                                                         
       int? age;                                                                                                                                                                                            
       String? ageGroup;  // 婴幼儿/儿童/青少年/成人/老年                                                                                                                                                   
       List<String> healthConditions;  // 控糖/三高/减脂/孕期等                                                                                                                                             
       List<String> allergies;                                                                                                                                                                              
       List<String> dislikes;                                                                                                                                                                               
     }                                                                                                                                                                                                      
                                                                                                                                                                                                            
     // 餐次设置                                                                                                                                                                                            
     @embedded                                                                                                                                                                                              
     class MealSettings {                                                                                                                                                                                   
       bool breakfast;                                                                                                                                                                                      
       bool lunch;                                                                                                                                                                                          
       bool dinner;                                                                                                                                                                                         
       bool snacks;                                                                                                                                                                                         
       int defaultPlanDays;                                                                                                                                                                                 
     }                                                                                                                                                                                                      
                                                                                                                                                                                                            
     // 食材库存                                                                                                                                                                                            
     @collection                                                                                                                                                                                            
     class Ingredient {                                                                                                                                                                                     
       Id id = Isar.autoIncrement;                                                                                                                                                                          
       int familyId;                                                                                                                                                                                        
       String name;                                                                                                                                                                                         
       String? category;  // 蔬菜/肉类/蛋奶/调味料等                                                                                                                                                        
       double quantity;                                                                                                                                                                                     
       String unit;                                                                                                                                                                                         
       String? freshness;  // 新鲜/一般/临期                                                                                                                                                                
       DateTime? expiryDate;                                                                                                                                                                                
       String? storageAdvice;                                                                                                                                                                               
       String? source;  // photo/voice/manual                                                                                                                                                               
       DateTime addedAt;                                                                                                                                                                                    
       DateTime updatedAt;                                                                                                                                                                                  
     }                                                                                                                                                                                                      
                                                                                                                                                                                                            
     // 菜谱                                                                                                                                                                                                
     @collection                                                                                                                                                                                            
     class Recipe {                                                                                                                                                                                         
       Id id = Isar.autoIncrement;                                                                                                                                                                          
       int? familyId;  // null 表示通用菜谱                                                                                                                                                                 
       String name;                                                                                                                                                                                         
       String? description;                                                                                                                                                                                 
       List<String> tags;  // 控糖友好/高蛋白/快手菜等                                                                                                                                                      
       int prepTime;                                                                                                                                                                                        
       int cookTime;                                                                                                                                                                                        
       int servings;                                                                                                                                                                                        
       List<RecipeIngredient> ingredients;                                                                                                                                                                  
       List<String> steps;                                                                                                                                                                                  
       String? tips;                                                                                                                                                                                        
       NutritionInfo? nutrition;                                                                                                                                                                            
       bool isFavorite;                                                                                                                                                                                     
       DateTime createdAt;                                                                                                                                                                                  
     }                                                                                                                                                                                                      
                                                                                                                                                                                                            
     // 菜谱食材                                                                                                                                                                                            
     @embedded                                                                                                                                                                                              
     class RecipeIngredient {                                                                                                                                                                               
       String name;                                                                                                                                                                                         
       double quantity;                                                                                                                                                                                     
       String unit;                                                                                                                                                                                         
       bool isOptional;                                                                                                                                                                                     
       String? substitute;                                                                                                                                                                                  
     }                                                                                                                                                                                                      
                                                                                                                                                                                                            
     // 营养信息                                                                                                                                                                                            
     @embedded                                                                                                                                                                                              
     class NutritionInfo {                                                                                                                                                                                  
       double? calories;                                                                                                                                                                                    
       double? protein;                                                                                                                                                                                     
       double? carbs;                                                                                                                                                                                       
       double? fat;                                                                                                                                                                                         
       double? fiber;                                                                                                                                                                                       
       String? summary;                                                                                                                                                                                     
     }                                                                                                                                                                                                      
                                                                                                                                                                                                            
     // 菜单计划                                                                                                                                                                                            
     @collection                                                                                                                                                                                            
     class MealPlan {                                                                                                                                                                                       
       Id id = Isar.autoIncrement;                                                                                                                                                                          
       int familyId;                                                                                                                                                                                        
       DateTime startDate;                                                                                                                                                                                  
       DateTime endDate;                                                                                                                                                                                    
       List<DayPlan> days;                                                                                                                                                                                  
       ShoppingList? shoppingList;                                                                                                                                                                          
       DateTime createdAt;                                                                                                                                                                                  
     }                                                                                                                                                                                                      
                                                                                                                                                                                                            
     // 单日计划                                                                                                                                                                                            
     @embedded                                                                                                                                                                                              
     class DayPlan {                                                                                                                                                                                        
       DateTime date;                                                                                                                                                                                       
       List<Meal> meals;                                                                                                                                                                                    
     }                                                                                                                                                                                                      
                                                                                                                                                                                                            
     // 单餐                                                                                                                                                                                                
     @embedded                                                                                                                                                                                              
     class Meal {                                                                                                                                                                                           
       String type;  // breakfast/lunch/dinner/snack                                                                                                                                                        
       List<int> recipeIds;                                                                                                                                                                                 
       String? notes;                                                                                                                                                                                       
     }                                                                                                                                                                                                      
                                                                                                                                                                                                            
     // 购物清单                                                                                                                                                                                            
     @embedded                                                                                                                                                                                              
     class ShoppingList {                                                                                                                                                                                   
       List<ShoppingItem> items;                                                                                                                                                                            
       DateTime generatedAt;                                                                                                                                                                                
     }                                                                                                                                                                                                      
                                                                                                                                                                                                            
     // 购物项                                                                                                                                                                                              
     @embedded                                                                                                                                                                                              
     class ShoppingItem {                                                                                                                                                                                   
       String category;                                                                                                                                                                                     
       String name;                                                                                                                                                                                         
       double quantity;                                                                                                                                                                                     
       String unit;                                                                                                                                                                                         
       String? notes;                                                                                                                                                                                       
       bool purchased;                                                                                                                                                                                      
     }                                                                                                                                                                                                      
                                                                                                                                                                                                            
     ---                                                                                                                                                                                                    
     AI 服务设计                                                                                                                                                                                            
                                                                                                                                                                                                            
     AI 功能点                                                                                                                                                                                              
     ┌──────────────┬────────────────────────┬──────────────────────────────────────────┬──────────────────────────┐                                                                                        
     │     功能     │          输入          │                   输出                   │         模型选择         │                                                                                        
     ├──────────────┼────────────────────────┼──────────────────────────────────────────┼──────────────────────────┤                                                                                        
     │ 食材图片识别 │ 图片                   │ 食材列表（名称、数量、新鲜度、存储建议） │ Claude Vision            │                                                                                        
     ├──────────────┼────────────────────────┼──────────────────────────────────────────┼──────────────────────────┤                                                                                        
     │ 语音转文字   │ 音频                   │ 文字                                     │ Web Speech API / Whisper │                                                                                        
     ├──────────────┼────────────────────────┼──────────────────────────────────────────┼──────────────────────────┤                                                                                        
     │ 食材文字解析 │ 用户输入文字           │ 结构化食材数据                           │ Claude                   │                                                                                        
     ├──────────────┼────────────────────────┼──────────────────────────────────────────┼──────────────────────────┤                                                                                        
     │ 菜单生成     │ 家庭档案 + 库存 + 偏好 │ 完整周计划                               │ Claude                   │                                                                                        
     ├──────────────┼────────────────────────┼──────────────────────────────────────────┼──────────────────────────┤                                                                                        
     │ 单菜谱生成   │ 食材 + 健康需求        │ 完整食谱                                 │ Claude                   │                                                                                        
     ├──────────────┼────────────────────────┼──────────────────────────────────────────┼──────────────────────────┤                                                                                        
     │ 营养估算     │ 菜谱内容               │ 营养数据                                 │ Claude                   │                                                                                        
     ├──────────────┼────────────────────────┼──────────────────────────────────────────┼──────────────────────────┤                                                                                        
     │ 购物清单优化 │ 菜单 + 库存            │ 采购清单                                 │ Claude                   │                                                                                        
     └──────────────┴────────────────────────┴──────────────────────────────────────────┴──────────────────────────┘                                                                                        
     AI Service 接口                                                                                                                                                                                        
                                                                                                                                                                                                            
     abstract class AIService {                                                                                                                                                                             
       // 图片识别                                                                                                                                                                                          
       Future<List<IngredientRecognition>> recognizeIngredients(Uint8List image);                                                                                                                           
                                                                                                                                                                                                            
       // 生成菜单                                                                                                                                                                                          
       Future<MealPlanResult> generateMealPlan({                                                                                                                                                            
         required Family family,                                                                                                                                                                            
         required List<Ingredient> inventory,                                                                                                                                                               
         required int days,                                                                                                                                                                                 
         required List<String> mealTypes,                                                                                                                                                                   
       });                                                                                                                                                                                                  
                                                                                                                                                                                                            
       // 根据库存推荐菜谱                                                                                                                                                                                  
       Future<List<Recipe>> suggestRecipes({                                                                                                                                                                
         required List<Ingredient> inventory,                                                                                                                                                               
         required Family family,                                                                                                                                                                            
         int count = 5,                                                                                                                                                                                     
       });                                                                                                                                                                                                  
                                                                                                                                                                                                            
       // 生成完整菜谱                                                                                                                                                                                      
       Future<Recipe> generateRecipe({                                                                                                                                                                      
         required String dishName,                                                                                                                                                                          
         required Family family,                                                                                                                                                                            
       });                                                                                                                                                                                                  
                                                                                                                                                                                                            
       // 营养分析                                                                                                                                                                                          
       Future<NutritionInfo> analyzeNutrition(Recipe recipe);                                                                                                                                               
                                                                                                                                                                                                            
       // 解析食材文字输入                                                                                                                                                                                  
       Future<List<Ingredient>> parseIngredientText(String text);                                                                                                                                           
     }                                                                                                                                                                                                      
                                                                                                                                                                                                            
     ---                                                                                                                                                                                                    
     页面结构与导航                                                                                                                                                                                         
                                                                                                                                                                                                            
     主要页面                                                                                                                                                                                               
                                                                                                                                                                                                            
     首页（Dashboard）                                                                                                                                                                                      
     ├── 快速入口卡片                                                                                                                                                                                       
     │   ├── 今日菜单                                                                                                                                                                                       
     │   ├── 库存概览                                                                                                                                                                                       
     │   ├── 快速添加食材                                                                                                                                                                                   
     │   └── 生成菜单                                                                                                                                                                                       
     │                                                                                                                                                                                                      
     家庭档案（Family）                                                                                                                                                                                     
     ├── 家庭列表/切换                                                                                                                                                                                      
     ├── 成员管理                                                                                                                                                                                           
     ├── 健康状况设置                                                                                                                                                                                       
     ├── 忌口与过敏                                                                                                                                                                                         
     └── 口味偏好                                                                                                                                                                                           
                                                                                                                                                                                                            
     库存管理（Inventory）                                                                                                                                                                                  
     ├── 库存列表                                                                                                                                                                                           
     ├── 添加食材                                                                                                                                                                                           
     │   ├── 拍照识别                                                                                                                                                                                       
     │   ├── 语音输入                                                                                                                                                                                       
     │   └── 手动输入                                                                                                                                                                                       
     ├── 库存编辑                                                                                                                                                                                           
     ├── 临期提醒                                                                                                                                                                                           
     └── 补货建议                                                                                                                                                                                           
                                                                                                                                                                                                            
     菜单计划（Menu）                                                                                                                                                                                       
     ├── 生成设置                                                                                                                                                                                           
     │   ├── 天数选择                                                                                                                                                                                       
     │   ├── 餐次选择                                                                                                                                                                                       
     │   └── 特殊要求                                                                                                                                                                                       
     ├── 菜单预览                                                                                                                                                                                           
     ├── 菜单调整                                                                                                                                                                                           
     └── 历史菜单                                                                                                                                                                                           
                                                                                                                                                                                                            
     菜谱（Recipe）                                                                                                                                                                                         
     ├── 收藏列表                                                                                                                                                                                           
     ├── 菜谱详情                                                                                                                                                                                           
     ├── 根据库存推荐                                                                                                                                                                                       
     └── AI 生成新菜谱                                                                                                                                                                                      
                                                                                                                                                                                                            
     购物清单（Shopping）                                                                                                                                                                                   
     ├── 清单列表                                                                                                                                                                                           
     ├── 清单详情                                                                                                                                                                                           
     ├── 导出/分享                                                                                                                                                                                          
     └── 勾选已购                                                                                                                                                                                           
                                                                                                                                                                                                            
     设置（Settings）                                                                                                                                                                                       
     ├── 语言切换                                                                                                                                                                                           
     ├── 主题设置                                                                                                                                                                                           
     ├── AI 配置                                                                                                                                                                                            
     ├── 数据管理                                                                                                                                                                                           
     └── 关于                                                                                                                                                                                               
                                                                                                                                                                                                            
     ---                                                                                                                                                                                                    
     实现步骤                                                                                                                                                                                               
                                                                                                                                                                                                            
     阶段一：项目基础（Week 1）                                                                                                                                                                             
                                                                                                                                                                                                            
     1. 初始化 Flutter 项目                                                                                                                                                                                 
     2. 配置项目结构                                                                                                                                                                                        
     3. 集成核心依赖（Riverpod、Isar、GoRouter）                                                                                                                                                            
     4. 实现主题系统（简洁清新风格）                                                                                                                                                                        
     5. 配置多语言框架                                                                                                                                                                                      
     6. 实现本地存储服务                                                                                                                                                                                    
                                                                                                                                                                                                            
     阶段二：家庭档案模块（Week 2）                                                                                                                                                                         
                                                                                                                                                                                                            
     1. 实现家庭数据模型                                                                                                                                                                                    
     2. 创建家庭管理页面                                                                                                                                                                                    
     3. 实现成员添加/编辑                                                                                                                                                                                   
     4. 健康状况选择组件                                                                                                                                                                                    
     5. 忌口与偏好设置                                                                                                                                                                                      
                                                                                                                                                                                                            
     阶段三：库存管理模块（Week 3-4）                                                                                                                                                                       
                                                                                                                                                                                                            
     1. 食材数据模型                                                                                                                                                                                        
     2. 库存列表页面                                                                                                                                                                                        
     3. AI 服务基础封装                                                                                                                                                                                     
     4. 拍照识别功能                                                                                                                                                                                        
     5. 语音输入功能                                                                                                                                                                                        
     6. 手动输入与解析                                                                                                                                                                                      
     7. 库存编辑与删除                                                                                                                                                                                      
     8. 保质期提醒逻辑                                                                                                                                                                                      
                                                                                                                                                                                                            
     阶段四：AI 菜单生成（Week 5-6）                                                                                                                                                                        
                                                                                                                                                                                                            
     1. 菜单生成页面                                                                                                                                                                                        
     2. AI 菜单生成逻辑                                                                                                                                                                                     
     3. 健康需求冲突处理（智能平衡）                                                                                                                                                                        
     4. 库存优先使用逻辑                                                                                                                                                                                    
     5. 菜单预览与调整                                                                                                                                                                                      
     6. 菜单历史记录                                                                                                                                                                                        
                                                                                                                                                                                                            
     阶段五：菜谱与营养（Week 7）                                                                                                                                                                           
                                                                                                                                                                                                            
     1. 菜谱详情页面                                                                                                                                                                                        
     2. 完整食谱展示                                                                                                                                                                                        
     3. 收藏功能                                                                                                                                                                                            
     4. 营养估算展示                                                                                                                                                                                        
     5. 根据库存推荐菜谱                                                                                                                                                                                    
                                                                                                                                                                                                            
     阶段六：购物清单（Week 8）                                                                                                                                                                             
                                                                                                                                                                                                            
     1. 自动生成购物清单                                                                                                                                                                                    
     2. 清单展示页面                                                                                                                                                                                        
     3. 多格式导出（文本/图片/PDF）                                                                                                                                                                         
     4. 分享功能                                                                                                                                                                                            
     5. 已购勾选                                                                                                                                                                                            
                                                                                                                                                                                                            
     阶段七：完善与优化（Week 9-10）                                                                                                                                                                        
                                                                                                                                                                                                            
     1. 库存自动扣减                                                                                                                                                                                        
     2. 补货智能建议                                                                                                                                                                                        
     3. 反馈学习机制                                                                                                                                                                                        
     4. 性能优化                                                                                                                                                                                            
     5. UI 细节打磨                                                                                                                                                                                         
     6. 多语言完善                                                                                                                                                                                          
                                                                                                                                                                                                            
     ---                                                                                                                                                                                                    
     关键依赖                                                                                                                                                                                               
                                                                                                                                                                                                            
     dependencies:                                                                                                                                                                                          
       flutter:                                                                                                                                                                                             
         sdk: flutter                                                                                                                                                                                       
                                                                                                                                                                                                            
       # 状态管理                                                                                                                                                                                           
       flutter_riverpod: ^2.4.0                                                                                                                                                                             
       riverpod_annotation: ^2.3.0                                                                                                                                                                          
                                                                                                                                                                                                            
       # 路由                                                                                                                                                                                               
       go_router: ^12.0.0                                                                                                                                                                                   
                                                                                                                                                                                                            
       # 本地存储                                                                                                                                                                                           
       isar: ^3.1.0                                                                                                                                                                                         
       isar_flutter_libs: ^3.1.0                                                                                                                                                                            
       path_provider: ^2.1.0                                                                                                                                                                                
                                                                                                                                                                                                            
       # AI & 网络                                                                                                                                                                                          
       http: ^1.1.0                                                                                                                                                                                         
       dio: ^5.3.0                                                                                                                                                                                          
                                                                                                                                                                                                            
       # 图片处理                                                                                                                                                                                           
       image_picker: ^1.0.4                                                                                                                                                                                 
       image: ^4.1.0                                                                                                                                                                                        
                                                                                                                                                                                                            
       # 语音                                                                                                                                                                                               
       speech_to_text: ^6.3.0                                                                                                                                                                               
                                                                                                                                                                                                            
       # UI                                                                                                                                                                                                 
       flutter_svg: ^2.0.7                                                                                                                                                                                  
       cached_network_image: ^3.3.0                                                                                                                                                                         
       shimmer: ^3.0.0                                                                                                                                                                                      
                                                                                                                                                                                                            
       # 导出                                                                                                                                                                                               
       pdf: ^3.10.0                                                                                                                                                                                         
       share_plus: ^7.2.0                                                                                                                                                                                   
       screenshot: ^2.1.0                                                                                                                                                                                   
                                                                                                                                                                                                            
       # 国际化                                                                                                                                                                                             
       flutter_localizations:                                                                                                                                                                               
         sdk: flutter                                                                                                                                                                                       
       intl: ^0.18.0                                                                                                                                                                                        
                                                                                                                                                                                                            
       # 工具                                                                                                                                                                                               
       uuid: ^4.1.0                                                                                                                                                                                         
       equatable: ^2.0.5                                                                                                                                                                                    
       freezed_annotation: ^2.4.0                                                                                                                                                                           
       json_annotation: ^4.8.0                                                                                                                                                                              
                                                                                                                                                                                                            
     dev_dependencies:                                                                                                                                                                                      
       build_runner: ^2.4.0                                                                                                                                                                                 
       riverpod_generator: ^2.3.0                                                                                                                                                                           
       isar_generator: ^3.1.0                                                                                                                                                                               
       freezed: ^2.4.0                                                                                                                                                                                      
       json_serializable: ^6.7.0                                                                                                                                                                            
       flutter_test:                                                                                                                                                                                        
         sdk: flutter                                                                                                                                                                                       
                                                                                                                                                                                                            
     ---                                                                                                                                                                                                    
     验证方案                                                                                                                                                                                               
                                                                                                                                                                                                            
     功能验证清单                                                                                                                                                                                           
                                                                                                                                                                                                            
     - 家庭档案                                                                                                                                                                                             
       - 可创建多个家庭并切换                                                                                                                                                                               
       - 可添加/编辑/删除家庭成员                                                                                                                                                                           
       - 健康状况可正确选择和保存                                                                                                                                                                           
       - 忌口和偏好正确影响菜单生成                                                                                                                                                                         
     - 库存管理                                                                                                                                                                                             
       - 拍照能识别食材（种类、数量、新鲜度）                                                                                                                                                               
       - 语音输入能正确解析为食材                                                                                                                                                                           
       - 手动输入能正确解析                                                                                                                                                                                 
       - 库存列表正确显示                                                                                                                                                                                   
       - 临期提醒正常工作                                                                                                                                                                                   
     - 菜单生成                                                                                                                                                                                             
       - 可选择 1-7 天生成                                                                                                                                                                                  
       - 可配置餐次                                                                                                                                                                                         
       - 优先使用库存食材                                                                                                                                                                                   
       - 健康冲突时能智能平衡                                                                                                                                                                               
       - 生成的菜单符合家庭需求                                                                                                                                                                             
     - 菜谱                                                                                                                                                                                                 
       - 显示完整食谱（用量、步骤、时间、技巧）                                                                                                                                                             
       - 可收藏菜谱                                                                                                                                                                                         
       - 能根据库存推荐菜谱                                                                                                                                                                                 
       - 营养估算显示正确                                                                                                                                                                                   
     - 购物清单                                                                                                                                                                                             
       - 自动生成正确                                                                                                                                                                                       
       - 支持文本复制                                                                                                                                                                                       
       - 支持导出图片/PDF                                                                                                                                                                                   
       - 支持分享                                                                                                                                                                                           
     - 整体                                                                                                                                                                                                 
       - 多语言切换正常                                                                                                                                                                                     
       - 数据本地持久化                                                                                                                                                                                     
       - 应用启动正常                                                                                                                                                                                       
       - 页面导航流畅                                                                                                                                                                                       
                                                                                                                                                                                                            
     测试方法                                                                                                                                                                                               
                                                                                                                                                                                                            
     1. 单元测试：数据模型、业务逻辑                                                                                                                                                                        
     2. Widget 测试：关键组件                                                                                                                                                                               
     3. 集成测试：核心用户流程                                                                                                                                                                              
     4. 手动测试：AI 功能、导出功能                                                                                                                                                                         
                                                                                                                                                                                                            
     ---                                                                                                                                                                                                    
     注意事项                                                                                                                                                                                               
                                                                                                                                                                                                            
     1. 语气风格：所有 AI 输出使用自然、口语化的家庭语气，不使用"我们家"                                                                                                                                    
     2. 健康声明：营养建议注明"仅供参考，不代替医生建议"                                                                                                                                                    
     3. API 密钥：需用户自行配置 Claude/GPT API 密钥                                                                                                                                                        
     4. 离线支持：考虑 AI 服务不可用时的降级方案                                                                                                                                                            
     5. 隐私保护：所有家庭数据仅存储本地 
